{"ast":null,"code":"import _regeneratorRuntime from\"/Users/cyril/crwn-clothing/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/cyril/crwn-clothing/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Users/cyril/crwn-clothing/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React,{useEffect}from'react';import{Route,Switch,Redirect}from'react-router-dom';import{useDispatch,useSelector,shallowEqual}from'react-redux';import HomePage from'./pages/homePage/homePage';import ShopPage from'./pages/shopPage';import Header from'./components/header';import SignInAndUp from'./pages/signInAndUp';import{auth,createUserProfileDocument}from'./firebase/index';import CheckoutPage from'./pages/checkoutPage';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var mapStateToProps=function mapStateToProps(_ref){var currentUser=_ref.currentUser;return{currentUser:currentUser};};// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nvar App=function App(){var _useSelector=useSelector(mapStateToProps,shallowEqual),currentUser=_useSelector.currentUser;var dispatch=useDispatch();useEffect(function(){var unsubscribeFromAuth=auth.onAuthStateChanged(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(user){var userRef;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!user){_context.next=7;break;}_context.next=3;return createUserProfileDocument(user);case 3:userRef=_context.sent;userRef===null||userRef===void 0?void 0:userRef.onSnapshot(function(snapShot){dispatch({type:'SET_CURRENTUSER',data:_objectSpread({id:snapShot.id},snapShot.data())});});_context.next=8;break;case 7:dispatch({type:'SET_CURRENTUSER',data:null});case 8:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}());return function(){return unsubscribeFromAuth();};},[dispatch]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Route,{exact:true,path:\"/\",component:HomePage}),/*#__PURE__*/_jsx(Route,{path:\"/shop\",component:ShopPage}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/signin\",render:function render(){return currentUser?/*#__PURE__*/_jsx(Redirect,{to:\"/\"}):/*#__PURE__*/_jsx(SignInAndUp,{});}}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/checkout\",component:CheckoutPage})]})]});};export default App;","map":{"version":3,"sources":["/Users/cyril/crwn-clothing/src/App.js"],"names":["React","useEffect","Route","Switch","Redirect","useDispatch","useSelector","shallowEqual","HomePage","ShopPage","Header","SignInAndUp","auth","createUserProfileDocument","CheckoutPage","mapStateToProps","currentUser","App","dispatch","unsubscribeFromAuth","onAuthStateChanged","user","userRef","onSnapshot","snapShot","type","data","id"],"mappings":"+aAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,OAASC,KAAT,CAAgBC,MAAhB,CAAwBC,QAAxB,KAAyC,kBAAzC,CACA,OAASC,WAAT,CAAsBC,WAAtB,CAAmCC,YAAnC,KAAuD,aAAvD,CACA,MAAOC,CAAAA,QAAP,KAAqB,2BAArB,CACA,MAAOC,CAAAA,QAAP,KAAqB,kBAArB,CACA,MAAOC,CAAAA,MAAP,KAAmB,qBAAnB,CACA,MAAOC,CAAAA,WAAP,KAAwB,qBAAxB,CACA,OAASC,IAAT,CAAeC,yBAAf,KAAgD,kBAAhD,CACA,MAAOC,CAAAA,YAAP,KAAyB,sBAAzB,C,wFAEA,GAAMC,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,UAAGC,CAAAA,WAAH,MAAGA,WAAH,OAAsB,CAC1CA,WAAW,CAAXA,WAD0C,CAAtB,EAAxB,CAIA;AACA,GAAMC,CAAAA,GAAG,CAAG,QAANA,CAAAA,GAAM,EAAM,CACd,iBAAwBX,WAAW,CAACS,eAAD,CAAkBR,YAAlB,CAAnC,CAAQS,WAAR,cAAQA,WAAR,CACA,GAAME,CAAAA,QAAQ,CAAGb,WAAW,EAA5B,CAEAJ,SAAS,CAAC,UAAM,CACZ,GAAMkB,CAAAA,mBAAmB,CAAGP,IAAI,CAACQ,kBAAL,2FAAwB,iBAAOC,IAAP,kIAC5CA,IAD4C,+CAEtBR,CAAAA,yBAAyB,CAACQ,IAAD,CAFH,QAEtCC,OAFsC,eAG5CA,OAAO,OAAP,EAAAA,OAAO,SAAP,QAAAA,OAAO,CAAEC,UAAT,CAAoB,SAACC,QAAD,CAAc,CAC9BN,QAAQ,CAAC,CACLO,IAAI,CAAE,iBADD,CAELC,IAAI,gBACAC,EAAE,CAAEH,QAAQ,CAACG,EADb,EAEGH,QAAQ,CAACE,IAAT,EAFH,CAFC,CAAD,CAAR,CAOH,CARD,EAH4C,6BAa5CR,QAAQ,CAAC,CACLO,IAAI,CAAE,iBADD,CAELC,IAAI,CAAE,IAFD,CAAD,CAAR,CAb4C,sDAAxB,gEAA5B,CAmBA,MAAO,kBAAMP,CAAAA,mBAAmB,EAAzB,EAAP,CACH,CArBQ,CAqBN,CAACD,QAAD,CArBM,CAAT,CAuBA,mBACI,oCACI,KAAC,MAAD,IADJ,cAEI,MAAC,MAAD,yBACI,KAAC,KAAD,EAAO,KAAK,KAAZ,CAAa,IAAI,CAAC,GAAlB,CAAsB,SAAS,CAAEV,QAAjC,EADJ,cAEI,KAAC,KAAD,EAAO,IAAI,CAAC,OAAZ,CAAoB,SAAS,CAAEC,QAA/B,EAFJ,cAGI,KAAC,KAAD,EAAO,KAAK,KAAZ,CAAa,IAAI,CAAC,SAAlB,CAA4B,MAAM,CAAE,wBAAMO,CAAAA,WAAW,cAAG,KAAC,QAAD,EAAU,EAAE,CAAC,GAAb,EAAH,cAAyB,KAAC,WAAD,IAA1C,EAApC,EAHJ,cAII,KAAC,KAAD,EAAO,KAAK,KAAZ,CAAa,IAAI,CAAC,WAAlB,CAA8B,SAAS,CAAEF,YAAzC,EAJJ,GAFJ,GADJ,CAWH,CAtCD,CAyCA,cAAeG,CAAAA,GAAf","sourcesContent":["import React, { useEffect } from 'react';\nimport { Route, Switch, Redirect } from  'react-router-dom';\nimport { useDispatch, useSelector, shallowEqual } from 'react-redux';\nimport HomePage from './pages/homePage/homePage';\nimport ShopPage from './pages/shopPage';\nimport Header from './components/header';\nimport SignInAndUp from './pages/signInAndUp';\nimport { auth, createUserProfileDocument } from './firebase/index';\nimport CheckoutPage from './pages/checkoutPage';\n\nconst mapStateToProps = ({ currentUser }) => ({\n    currentUser,\n});\n\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nconst App = () => {\n    const { currentUser } = useSelector(mapStateToProps, shallowEqual);\n    const dispatch = useDispatch();\n   \n    useEffect(() => {\n        const unsubscribeFromAuth = auth.onAuthStateChanged(async (user) => {\n            if (user) {\n                const userRef = await createUserProfileDocument(user);\n                userRef?.onSnapshot((snapShot) => {\n                    dispatch({\n                        type: 'SET_CURRENTUSER',\n                        data: {\n                            id: snapShot.id,\n                            ...snapShot.data(),\n                        }\n                    });\n                });\n            } else {\n                dispatch({\n                    type: 'SET_CURRENTUSER',\n                    data: null,\n                });\n            }\n        });\n        return () => unsubscribeFromAuth();\n    }, [dispatch]);\n\n    return (\n        <div>\n            <Header />\n            <Switch>\n                <Route exact path=\"/\" component={HomePage}/>\n                <Route path=\"/shop\" component={ShopPage}/>\n                <Route exact path=\"/signin\" render={() => currentUser ? <Redirect to='/' /> : <SignInAndUp /> }/>\n                <Route exact path=\"/checkout\" component={CheckoutPage}/>\n            </Switch>\n        </div>\n    );\n};\n\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}